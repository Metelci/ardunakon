# Arduino Mega 2560 Setup Guide

Setup instructions for Arduino Mega with external Bluetooth modules and Hardware Serial.

## Overview

| Feature | Specification |
|---------|--------------|
| **MCU** | ATmega2560 |
| **Voltage** | 5V |
| **PWM Pins** | 2-13, 44-46 |
| **Hardware Serial** | Serial1 (D18/D19), Serial2 (D16/D17), Serial3 (D14/D15) |
| **Bluetooth** | External (uses Serial1) |

---

## Advantage Over UNO

The Mega uses **Hardware Serial** instead of SoftwareSerial, providing:
- ✅ More reliable communication
- ✅ Higher baud rates supported
- ✅ No timing conflicts with PWM

---

## Wiring Diagram

### HC-05/HC-06 via Serial1

```
┌─────────────────────────────────────────────────────────────────┐
│                       Arduino Mega 2560                          │
│  ┌───────────────────────────────────────────────────────────┐  │
│  │                                                           │  │
│  │  Serial1 TX (D18) ●──────────────────► RX (HC-05)        │  │
│  │  Serial1 RX (D19) ●◄───────────────── TX (HC-05)        │  │
│  │                                                           │  │
│  │            5V ●◄──────────────────── VCC                 │  │
│  │           GND ●◄──────────────────── GND                 │  │
│  │                                                           │  │
│  │  ┌─────────── Motor Pins ───────────┐                    │  │
│  │  │  D9  = ENA (Left PWM)            │                    │  │
│  │  │  D8  = IN1                       │                    │  │
│  │  │  D7  = IN2                       │                    │  │
│  │  │  D6  = ENB (Right PWM)           │                    │  │
│  │  │  D5  = IN3                       │                    │  │
│  │  │  D4  = IN4                       │                    │  │
│  │  └──────────────────────────────────┘                    │  │
│  │                                                           │  │
│  │  ┌─────────── Servo Pins ───────────┐                    │  │
│  │  │  D2  = Servo X                   │                    │  │
│  │  │  D12 = Servo Y                   │                    │  │
│  │  │  D11 = Servo Z                   │                    │  │
│  │  └──────────────────────────────────┘                    │  │
│  │                                                           │  │
│  └───────────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────────┘

          HC-05/HC-06 Module
         ┌──────────────────┐
         │  STATE ●         │
         │    RXD ●◄────────┼── Mega TX1 (D18) via voltage divider
         │    TXD ●─────────┼─► Mega RX1 (D19)
         │    GND ●◄────────┼── GND
         │    VCC ●◄────────┼── 5V
         │     EN ●         │
         └──────────────────┘
```

### Voltage Divider for TX→RX

```
Mega D18 (TX1) ───┬─── 1kΩ ───┬─── HC-05 RX
                  │           │
                  └─── 2kΩ ───┴─── GND
```

---

## Software Changes

The Mega sketch uses `Serial1` instead of SoftwareSerial:

```cpp
// In ArdunakonMega.ino
void setup() {
    Serial.begin(115200);   // USB debug
    Serial1.begin(9600);    // Bluetooth on D18/D19
}

void loop() {
    if (Serial1.available() >= 10) {
        // Process packet...
    }
}
```

---

## Troubleshooting

### No Connection on Serial1

- Verify D18 (TX1) connects to module RX
- Verify D19 (RX1) connects to module TX
- Check voltage divider on TX1

### Using Other Serial Ports

| Port | TX Pin | RX Pin |
|------|--------|--------|
| Serial1 | D18 | D19 |
| Serial2 | D16 | D17 |
| Serial3 | D14 | D15 |

---

## Pin Reference

| Function | Pin | Notes |
|----------|-----|-------|
| Bluetooth TX | D18 | Serial1 TX |
| Bluetooth RX | D19 | Serial1 RX |
| Left Motor PWM | D9 | ENA |
| Left Motor Dir1 | D8 | IN1 |
| Left Motor Dir2 | D7 | IN2 |
| Right Motor PWM | D6 | ENB |
| Right Motor Dir1 | D5 | IN3 |
| Right Motor Dir2 | D4 | IN4 |

---

*Last updated: 2025-12-21*
